---
title: "FormattableTables"
author: "Elliott Schmidt"
date: "11/03/2022"
output:
  html_document: 
    theme: spacelab
    toc: true
    toc_float: true  
    collapsed: true
    smooth_scroll: true
fontsize: 12pt
mainfont: Arial
monofont: DejaVu Sans Mono
classoption: a4paper
---
# Setup 

Download necessary packages  

```{r packages_needed, message=FALSE, warning=FALSE} 
library(usethis) 
library(dataaimsr) 
library(purrr)
library(tidyverse)
library(lubridate)
library(reshape2)
library(formattable)
library(DT)
library(ggplot2)
library(kableExtra)
```
Before beginning you need to make sure that your **AIMS API Key** is hidden in your a **.Renviron** file. To create an .Renviron file you can use the following code. 

```{r renviron_file, eval=FALSE}
usethis::edit_r_environ()
```
Within your newly create .Renviron file enter your AIMS API Key as AIMS_DATAPLATFORM_API_KEY=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 

Double check that your .gitignore file contains 

```{r gitignore, eval=FALSE}
# R Environment Variables
.Renviron
```
This will prevent you from accidentally pushing your AIMS API Key onto GitHub. Your AIMS API Key is meant just for you, donot put it on GitHub. To check that your AIMS API Key is stored correctly run 

```{r aims_api_key1, results="hide"}
Sys.getenv("AIMS_DATAPLATFORM_API_KEY")
```
If your AIMS API Key shows up, then it is stored correctly. But we don't want to be typing it out every time. Therefore hide it in a new variable called **my_api_key**

```{r aims_api_key2}
my_api_key <- Sys.getenv("AIMS_DATAPLATFORM_API_KEY") 
```

# Importing data from AIMS  

Lets looks at what attributes we can filter by
```{r importing_data}
dataaimsr::aims_expose_attributes("temp_loggers") 
```

Lets look at a summary of data by reef
```{r importing_data2, message=FALSE, results='hide'}
summary_series_data <- aims_data("temp_loggers", api_key = my_api_key,
          summary = "summary-by-series")
head(summary_series_data)
```
```{r importing_data3, echo=FALSE}
kable(as.data.frame(head(summary_series_data)), "html") %>% 
  kable_styling("striped") %>% 
  scroll_box(width = "100%")
```


Lets try to get a summary of daily temperatures from a Agincourt Reef Number 3 and set an interval of dates 
```{r importing_data4, message=FALSE, results='hide'}
davies <- aims_data("temp_loggers", 
                       api_key = my_api_key, 
                       summary = "daily",
                       filters = list(
                         "series" = "DAVSL1",
                         "from_date" = "2010-03-16T00:00:00",
                         "thru_date" = "2020-01-07T00:00:00"
)) ; head(davies)
```

```{r importing_data5, echo=FALSE}
kable(head(davies), "html") %>% 
  kable_styling("striped") %>% 
  scroll_box(width = "100%")
```
